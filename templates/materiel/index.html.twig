{%  extends 'baseBack.html.twig' %}


{% block title %} Liste des Materiels {% endblock %}

{% block body %}
        <!-- PAGE CONTAINER-->

                                <!-- START WHITE BACKGROUND-->


                                    <!-- USER DATA-->
                                    <div class="user-data m-b-40">
                                        <h3 class="title-3 m-b-30">
                                           <i class="fa-solid fa-dumbbell"></i>  Gestion Des Materiels</h3>
                                        <div class="filters m-b-45">
                                            <div class="rs-select2--dark rs-select2--md m-r-10 rs-select2--border">
                                                <select class="js-select2" name="property">
                                                    <option selected="selected">Filtrer</option>
                                                   <option value="1"><a href="{{ path('app_materiel_tri') }}">Nom</a></option>
                                                    <option value="2">Maintenance</option>lik
                                                </select>
                                                <div class="dropDownSelect2"></div>
                                            </div>

                                        </div>
                                        <br>
                                            <br>
                                            
                                        <div class="input-group">
                                        {#//recherche #}
                                                <div class="container-fluid" style="display:flex;justify-content:flex-end;align-items:flex-end;">
                                                    <div class="header-wrap">
                                                        <form class="form-header" action="" method="GET">
                                                            <input type="text" class="au-input au-input--xl" id="searchInput" placeholder="Search&hellip;">
                                                            <button class="au-btn--submit" type="submit">
                                                                <i class="zmdi zmdi-search"></i>
                                                            </button>
                                                        </form>
                                                    </div>
                                                </div>


                                            <script>
                                                function filterTable() {
                                                    const filter = document.getElementById('searchInput').value.toUpperCase();
                                                    const rows = document.querySelectorAll('table tr');
                                                    for (let i = 1; i < rows.length; i++) {
                                                        const cols = rows[i].querySelectorAll('td');
                                                        let visible = false;
                                                        for (let j = 0; j < cols.length; j++) {
                                                            const cell = cols[j];
                                                            if (cell.innerText.toUpperCase().indexOf(filter) > -1) {
                                                                visible = true;
                                                                break;
                                                            }
                                                        }
                                                        rows[i].style.display = visible ? '' : 'none';
                                                    }
                                                }
                                                document.getElementById('searchInput').addEventListener('keyup', filterTable);
                                            </script>
                                        <div class="table-responsive table-data">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <td>Id</td>
                                                    <td>Nom materiel</td>
                                                    <td>Reference materiel</td>
                                                    <td>Maintenance materiel</td>
                                                    <td>Quantite materiel</td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                {% for materiel in materiels %}
                                                    <tr>
                                                        <td style="text-align: center">{{ materiel.id }}</td>
                                                        <td style="text-align: center">{{ materiel.nomMateriel }}</td>
                                                        <td style="text-align: center">{{ materiel.referenceMateriel }}</td>
                                                        <td style="text-align: center">{{ materiel.dateMaintenanceMateriel ? materiel.dateMaintenanceMateriel|date('Y-m-d') : '' }}</td>
                                                        <td style="text-align: center">{% if materiel.quantiteMateriel == 0 %}0{% else %} {{ materiel.quantiteMateriel }} {% endif %}</td>

                                                        <td style="text-align: center">
                                                            <a class="btn btn-outline-secondary" href="{{ path('app_materiel_show', {'id': materiel.id}) }}">show</a>
                                                        </td>
                                                        <td style="text-align: center">
                                                            <a class="btn btn-outline-secondary" href="{{ path('app_materiel_edit', {'id': materiel.id}) }}">edit</a>
                                                        </td>
                                                    </tr>
                                                {% else %}
                                                    <tr>
                                                        <td colspan="6">no records found</td>
                                                    </tr>
                                                {% endfor %}



                                                </tbody>

                                            </table>


                                        </div>

                                        </div>
                                        <canvas id="myChart" style="width:100%;max-width:600px;text-align: center"></canvas>
                                        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

                                        <script>
                                            var xValues = [];
                                            var yValues = [];
                                            {% for materiel in materiels %}
                                            xValues.push("{{ materiel.nomMateriel }}");
                                            yValues.push("{{ materiel.quantiteMateriel }}");
                                            {% endfor %}

                                            new Chart("myChart", {
                                                type: "bar",
                                                data: {
                                                    labels: xValues,

                                                    datasets: [{
                                                        backgroundColor: [
                                                            'rgba(255, 99, 132, 0.2)',
                                                            'rgba(54, 162, 235, 0.2)',
                                                            'rgba(255, 206, 86, 0.2)',
                                                            'rgba(75, 192, 192, 0.2)',
                                                            'rgba(153, 102, 255, 0.2)',
                                                            'rgba(255, 159, 64, 0.2)'
                                                        ],
                                                        borderColor: [
                                                            'rgba(255, 99, 132, 1)',
                                                            'rgba(54, 162, 235, 1)',
                                                            'rgba(255, 206, 86, 1)',
                                                            'rgba(75, 192, 192, 1)',
                                                            'rgba(153, 102, 255, 1)',
                                                            'rgba(255, 159, 64, 1)'
                                                        ],
                                                        borderWidth: 2,
                                                        data: yValues,
                                                    }]
                                                },
                                                options: {
                                                    legend: {display: false},
                                                    title: {
                                                        display: true,
                                                        text: "Quantités des matériels",
                                                        fontColor: 'rgba(120,10,10,1.8)', // sets font color for y-axis labels

                                                    },
                                                    animation: {
                                                        duration: 5000,
                                                        easing: 'easeOutBounce' // add a bouncing effect at the end of the animation
                                                    },

                                                    scales: {
                                                        yAxes: [{
                                                            ticks: {
                                                                beginAtZero: true,
                                                                fontColor: 'rgba(120,10,10,1.8)', // sets font color for y-axis labels
                                                                fontSize: 14 // sets font size for y-axis labels
                                                            }
                                                        }],
                                                        xAxes: [{
                                                            ticks: {
                                                                fontColor: 'rgba(120,10,10,1.8)', // sets font color for x-axis labels
                                                                fontSize: 14 // sets font size for x-axis labels
                                                            }
                                                        }]
                                                    }
                                                }
                                            });

                                        </script>

                                        </div>
                                        <div align="center" class="card-footer">
                                            <a type="reset" class="btn btn-danger btn-sm" href="{{ path('app_materiel_new') }}">Create new</a>
                                        </div>
                                    <!-- END USER DATA-->


                                <!-- END WHITE BACKGROUND-->





{% endblock %}
